<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <!-- 让 Bootstrap 兼容 IE 兼容模型 -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- 让 Bootstrap 兼容 国产浏览器的高速模型 -->
    <meta name="renderer" content="webkit">
    <!-- 实现响应式的设置 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>相关性分析</title>
    <!-- 引入 Bootstrap 的 CSS 文件 -->
    <link href="../../css/bootstrap/bootstrap.css" rel="stylesheet">
    <link href="../../css/bootstrap/bootstrap.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/bootstrap/dist/css/bootstrap.css"/>
    <link rel="stylesheet" href="../../css/H-ui/H-ui.css"/>
    <link rel="stylesheet" href="../../css/clusterAnalysis.css"/>
    <script src="../../js/angular/angular.js"></script>
    <style>
        ::-webkit-scrollbar {        width: 8px;
            height: 8px;}
        /* 滚动槽 */
        ::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px #fff;
            border-radius: 5px;
            width: auto;
        }
        /* 滚动条滑块 */
        ::-webkit-scrollbar-thumb {
            height: 50px;
            background-color: #D2D2D2;
            -webkit-border-radius: 4px;
            outline: #D2D2D2 solid 1px;
            outline-offset: -2px;
            border: 1px solid #D2D2D2;
        }
        .dsgGroup{
            margin-bottom: 10px;
            height: 32px;
        }
        /*拖动框中的删除*/
        .remove{
            cursor: pointer;
            position: absolute;
            top: 4px;
            right: 4px;
            color: #dbdbdb;
        }
        .remove:hover{
            color:#000;
        }
    </style>
</head>
<body>
<div class="nav navbar-default navbar-fixed-top">
    <div>
        <div class="lf">
            <a href="#"> <img src="../../images/07.png" style="width: 90px;"/></a>
            <span style="font-size: 18px">&nbsp;&nbsp;| &nbsp;&nbsp;相关性分析</span>
        </div>
        <div class="rt">
            <ul id="list">

                <li>
                    <a href="#">数据挖掘&nbsp;<span class="caret"></span></a>
                    <ul>
                        <li class="">
                            <a href="clusterAnalysis.html">聚类分析</a>
                        </li>
                        <li><a href="dataPrediction.html">数据预测</a></li>
                        <li><a href="associationAnalysis.html">关联分析</a></li>
                        <li><a href="correlationAnalysis.html">相关性分析</a></li>
                    </ul>
                </li>
                <li data-target="#myModal" data-toggle="modal">
                    <a href="#">数据分析</a>
                </li>
                <li data-toggle="modal" data-target="#myModal">
                    <a href="#">仪表盘</a>
                </li>
                <li>
                    <a href="#"><span id="navList" class="glyphicon glyphicon-user"></span><span class="caret"></span></a>
                    <ul>
                        <li><a href="#">15690053779</a></li>
                        <li><a href="">退出</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="dsg-mian">
    <div class="dsg-left">
        <div class="dsg-left-main">
            <ul class="nav nav-tabs" role="tablist">
                <li role="presentation" class="active"><a href=".myData" role="tab" data-toggle="tab">我的数据</a></li>
            </ul>
            <div class="tab-content heightAll" data-spy="scroll">
                <div role="tabpanel" class="tab-pane active myData">
                    <div class="dsg-group-header">
                        <div class="dsg-search">
                            <form action="">
                                <input type="text" class="search-txt" name="txt" id="search" placeholder="输入你搜索的内容"/>
                                <span class="glyphicon glyphicon-search search"></span>
                            </form>
                        </div>
                    </div>
                    <div class="dsg-group-scroll">
                        <ul class="dsg-group-theme panel-group" id="accordion">
                            <li></li>
                            <li>
                                <div class="addData">
                                        <span>
                                            你当前没有数据
                                            <br/>
                                            请点击添加
                                        </span>
                                </div>
                            </li>
                            <li class="list-drag">
                                <div type="button" class="dragName"data-parent="#accordion" data-toggle="collapse" data-target="#demo" aria-expanded="true" aria-controls="demo">
                                    <div class="dsg-myData">超市零售</div>
                                </div>
                                <form action="" class="drag-rename">
                                    <input type="text" style="width:150px;height: 25px;line-height: 25px;padding-right: 16px" name="text" class="text"/>
                                    <img src="../../images/yzwc.png" class="sure" style="width: 14px;" alt=""/>
                                </form>
                                <div class="btn-group dataName">
                                    <span class="caret data-down" style="color: #fff;"></span>
                                </div>
                                <ul class="collapse in coll" id="demo">
                                    <li>
                                        <span style="font-size: 14px;font-weight: bold;position: relative;top: 0px;left: 3px;">维度</span>
                                        <div class="btn-group">
                                            <span class="caret dimension-down"></span>
                                        </div>
                                        <ul>
                                            <li class="group-second-body">
                                                <span class="icon glyphicon glyphicon-time"></span>
                                                <div class="group-item">
                                                    <a href="#" class="drag-content">订单日期</a>

                                                    <div class="btn-group btnG">
                                                        <span class="caret downList"></span>
                                                    </div>
                                                </div>
                                                <form action="" class="group-item-form">
                                                    <input type="text" class="group-item-txt" />
                                                    <span class="glyphicon glyphicon-ok list-sure"></span>
                                                </form>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <span style="font-size: 14px;font-weight: bold;position: relative;top: 0px;left: 3px;">量度</span>
                                        <div class="btn-group">
                                            <span class="caret measure-down"></span>
                                        </div>
                                        <ul>
                                            <li class="group-second-body">
                                                <span class="icon glyphicon glyphicon-time"></span>
                                                <div class="group-item">
                                                    <a href="#" class="drag-content" >销售额</a>
                                                    <div class="btn-group btnG">
                                                        <span class="caret measure-downList"></span>
                                                    </div>
                                                </div>
                                                <form action="" class="group-item-form">
                                                    <input type="text" class="group-item-txt" />
                                                    <span class="glyphicon glyphicon-ok list-sure"></span>
                                                </form>
                                            </li>
                                            <li class="group-second-body">
                                                <span class="icon glyphicon glyphicon-time"></span>
                                                <div class="group-item">
                                                    <a href="#" class="drag-content">折扣</a>

                                                    <div class="btn-group btnG">
                                                        <span class="caret measure-downList"></span>
                                                    </div>
                                                </div>
                                                <form action="" class="group-item-form">
                                                    <input type="text" class="group-item-txt" />
                                                    <span class="glyphicon glyphicon-ok list-sure"></span>
                                                </form>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane" id="publicData">...</div>
                <div role="tabpanel" class="tab-pane" id="exampleData">.. ds .</div>
            </div>
        </div>
    </div>
    <div class="dsg-center row" style="overflow-y: auto; float:right;margin-right:5px;width: calc(100% - (245px))!important;height: 548px;background: #fff;border:1px solid #dbdbdb">
        <div class="dsgGroup" style="margin: 0px">
            <div class="col-md-6">维度</div>
            <div class="col-md-6">度量</div>
        </div>
        <div class="dsgGroup">
            <div class="col-md-6" >
                <div id="timeD" style="position: relative; border: 1px dotted #ddd;height: 30px;line-height: 30px">
                    <span id="remove1" class="glyphicon glyphicon-trash remove" style=""></span>
                </div>
            </div>
            <div class="col-md-6">
                <div id="timeM" style="position: relative; border: 1px dotted #ddd;height: 30px;line-height: 30px">
                    <span id="remove2" class="glyphicon glyphicon-trash remove" style=""></span>
                </div>
            </div>
        </div>
        <div class="dsgGroup">
            <div class="col-md-8" >
            </div>
            <div class="col-md-4">
                <button class="btnCal" disabled style="width: 100px;text-align: center; border: 1px solid #ddd;height: 30px;line-height: 30px">开始分析</button>
                <img id="waiteImg" src="http://static.oschina.net/uploads/space/2014/0430/115223_oFLD_1163935_thumb.gif" style="width: 25px;display: none"/>
            </div>
        </div>
        <div class="col-lg-12 analysisResult" style="display: none">
            <div ng-app="dsgLichaoApp">
                <div ng-controller="lichaoCtrl">
                    <label style="color: #000;">
                        分析结果：
                    </label><br/>
                    <label style="color: #000;">度量分组情况</label>

                    <div class="" ng-show="true" style="max-height: 450px;overflow-y: auto;">
                        <table class="table table-responsive table-striped table-bordered table-hover">
                            <thead>
                            </thead>
                            <tbody class="">
                            <tr class="" ng-repeat="dataRow in dataRows" style=" ">
                                <!--<td>{{dataRows}}</td>-->
                                <td style="text-align: left" class="">{{dataRow.tdata}}</td>
                                <td style="text-align: left" class="">
                                    <ul>
                                        <li ng-repeat="lis in dataRow.tdata1"><span>{{lis.range0}}</span></li>
                                    </ul>
                                </td>
                            </tr>
                            </tbody>

                        </table>
                    </div>
                    <div class="" ng-show="true" style="max-height: 450px;overflow-y: auto;">
                        <h5>相关性分析结果 </h5>
                        <table class="table table-responsive table-striped table-bordered table-hover">
                            <thead>
                            <th style="color: #000;" class="text-center">标识</th>
                            <th style="color: #000;" class="text-center">置信度</th>
                            </thead>
                            <tbody class="">
                            <tr class="" ng-repeat="dataRow in dataRows1" style=" ">
                                <td style="text-align: left" class="">{{dataRow.xiao}}</td>
                                <td style="text-align: left" class="">{{dataRow.value}}</td>
                            </tr>
                            </tbody>

                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="action-list"></div>

</div>

<!-- 引入 jQuery 文件 -->
<script src="../../js/jquery/jquery.js"></script>
<script src="../../js/jquery/jquery-ui.js"></script>
<!-- 引入 Bootstrap 的 JS 文件 -->
<script src="../../js/bootstrap/bootstrap.js"></script>
</body>
<style>

</style>
<script>

    var myApp = angular.module('dsgLichaoApp',[]);
    myApp.controller('lichaoCtrl',['$scope','$http',function($scope, $http){
        $scope.isShow = false;
        $scope.show = function() {
            $scope.dataRows=[];
            $scope.dataRows1=[];
            $http.get('../json/xiang.json')
                    .success(function(data) {
                        if(data.code == 200) {
                            $scope.dataRows = (data.data);
                            $scope.dataRows1 = (data.data1);
                        }
                    })
        }

        $scope.show();
    }]);
    $( ".drag-content" ).draggable({
        cursor: "move",
        revert: "invalid",

        helper: function(obj){
            //$('.row-content').css('border','1px dashed blue')
            var txt=obj.target.firstChild.data;
            return "<div class='move' style='opacity: 0;'>"+txt+"</div>";
        },
        start:function(event,ui){
            $(this).parents('.list-drag').siblings()
                    .children('.drag-content').draggable({'disabled':true});
            //$('.heightAll').css('overflow','visible');
            $(ui.helper).css({'text-overflow':'inherit','width':'outo'})
            $(this).parents('.list-drag').siblings().find("li .drag-content").draggable({'disabled':true});
            var x = event.pageX;
            var y = event.pageY;
            console.log(x,y);
            //var txt=ui.target.firstChild.data;
            console.log($(this).html());
            var btn_=$('<div class="move"></div>');
            btn_.html($(this).html());
            btn_.css({'position':'absolute',"top":(y-15)+'px','left':(x-75)+'px'});
            //$('.move').remove();
            $('body').append(btn_);
        },
        drag:function(e,ui){
            //console.log(ui.helper);
            e.stopPropagation();
            var x = event.pageX;
            var y = event.pageY;
            $('.move').css({'position':'absolute',"top":(y-15)+'px','left':(x-75)+'px'});
            //console.log(x,y);
        },
        stop:function(event,ui){
            $('.move').remove();
            var timedL=$("#timeD .ui-draggable-handle").length;
            var timemL=$("#timeM .ui-draggable-handle").length;
            if(timedL>0&&timemL>1){
                $('.btnCal').removeAttr('disabled').css({"border":"1px solid #00AFF6","background":"#fff","color":"#00AFF6","opacity":"1"})
                        .hover(function(){
                            $(this).css({"background":"#00AFF6","color":"#fff"});
                        }).mouseout(function(){
                            $(this).css({"border":"1px solid #00AFF6","background":"#fff","color":"#00AFF6","opacity":"1"});
                        });
                $('.selectShow').show();
            }else{
                $('.btnCal').attr('disabled',true).css({"border":"1px solid #ddd","background":"#ddd","color":"#000","opacity":"0.5"});
                $('.selectShow').hide();
            }
        }

    });

    $( "#timeD" ).droppable({
        activeClass: "active",
        hoverClass: "hover",
        drop: function( event, ui ) {
            var helper=ui.helper;
            console.log(helper);
            var cc=helper[0];
            var cc1=$(cc).clone().removeAttr("class").removeAttr("style")
                    .addClass('dropMove');
            $(cc1).appendTo("#timeD");
            $(cc1).draggable({
                cursor: "move",
                start: function (event,ui){
                    $(this).css({"z-index":"1000","opacity":0});
                    var x = event.pageX;
                    var y = event.pageY;
                    console.log(x,y);
                    console.log($(this).html());
                    var btn_=$('<div class="dropDrag"></div>');
                    btn_.html($(this).html());
                    btn_.css({'position':'absolute',"top":(y-15)+'px','left':(x-75)+'px'});
                    $('body').append(btn_);
                },
                drag:function(e,ui){
                    //console.log(ui.helper);
                    e.stopPropagation();
                    $(this).css({"position":"absolute","z-index":100000})
                    var x = e.pageX;
                    var y = e.pageY;
                    $('.dropDrag').css({'position':'absolute',"top":(y-13)+'px','left':(x-50)+'px'});
                    //console.log(x,y);
                },
                stop: function( event, ui ) {
                    $(ui.helper[0]).remove();
                    $('.dropDrag').remove();
                    //写元素脱出行时显示
                    var timedL=$("#timeD .ui-draggable-handle").length;
                    var timemL=$("#timeM .ui-draggable-handle").length;
                    if(timedL>0&&timemL>1){
                        $('.btnCal').removeAttr('disabled').css({"border":"1px solid blue"});
                        $('.analysisResult').show();
                    }else{
                        $('.btnCal').attr('disabled',true).css({"border":"1px solid #ddd","background":"#ddd","color":"#000","opacity":"0.5"});
                        $('.analysisResult').hide();
                    }
                    if(timedL==0&&timemL==0){
                        $('.sales').val('请输入数值');
                        $('.nums').val('请输入数值');
                        $('.dope-result').hide(100);
                    }
                }
            });
        },
        activate:function(event, ui ){
            console.info("activate");
            $('#timeD').css('border','1px dotted #00CCFF')

        },
        create:function(event, ui){
            //console.info("create");
        },
        deactivate:function(event, ui){
            $('#timeD').css('border','1px dashed #ddd')
            //console.info("-------------------------------");
            //$('.heightAll').css('overflow','auto');
            var rowL=$('#timeD .ui-draggable-handle').length;
            if(rowL>1&&rowL==2){
                $('#btnCluster').removeAttr('disabled').css({'background':'#0099FF','color':'#fff'})
            }
        },
        out:function(event, ui){
            var rowL=$('#timeD .ui-draggable-handle').length;
            if(rowL==0){
                $('.info').show();
            }
            //console.info("777777777777777777777777777777777");

        },
        over:function(event,ui){
            $('.info').hide();
            console.log("over")
        },
        tolerance: "touch"
    });
    $( "#timeM" ).droppable({
        activeClass: "active",
        hoverClass: "hover",
        drop: function( event, ui ) {
            var helper=ui.helper;
            var cc=helper[0];
            var cc1=$(cc).clone().removeAttr("class").removeAttr("style").addClass('dropMove');
            $(cc1).appendTo("#timeM");
            $(cc1).draggable({
                cursor: "move",
                start: function (event, ui) {
                    $(this.target).css({"z-index":"1000","opacity":0});
                    var x = event.pageX;
                    var y = event.pageY;
                    console.log(x,y);
                    $(ui.helper[0]).css({'opacity':'0'});
                    var btn_=$('<div class="dropDrag"></div>');
                    btn_.html($(this).html());
                    btn_.css({'position':'absolute',"top":(y-15)+'px','left':(x-75)+'px'});
                    //$('.move').remove();
                    $('body').append(btn_);
                },
                drag:function(e,ui){
                    e.stopPropagation();
                    $(this).css({"position":"absolute","z-index":100000})
                    var x = e.pageX;
                    var y = e.pageY;
                    $('.dropDrag').css({'position':'absolute',"top":(y-13)+'px','left':(x-50)+'px'});
                    //console.log(x,y);
                },
                stop: function( event, ui ) {
                    //写元素脱出行时显示
                    $(ui.helper[0]).remove();
                    $('.dropDrag').remove();
                    var timedL=$("#timeD .ui-draggable-handle").length;
                    var timemL=$("#timeM .ui-draggable-handle").length;
                    if(timedL>0&&timemL>1){
                        $('.btnCal').removeAttr('disabled').css({"border":"1px solid blue"});
                        //$('.analysisResult').show();
                    }else{
                        $('.btnCal').attr('disabled',true).css({"border":"1px solid #ddd","background":"#ddd","color":"#000","opacity":"0.5"});
                        //$('.analysisResult').hide();
                    }
                    if(timedL==0&&timemL==0){
                        $('.analysisResult').hide();
                    }else{
                        $('.analysisResult').show();
                    }
//				 	alert("======================");
                }
            });


            //console.log("stop");
        },
        activate:function(event, ui ){
            //console.info("activate");
            $('#timeM').css('border','1px dotted #00CCFF')

        },
        create:function(event, ui){
            //console.info("===========================");
        },
        deactivate:function(event, ui){
            //console.info("-------------------------------");
            $('#timeM').css('border','1px dashed #ddd');
        },
        out:function(event, ui){
//                    console.log(r.length);

        },
        over:function(event,ui){
            //console.log("over")
            var listL=$('.list-view .ui-draggable-handle').length;
            if(listL<1){
                $('#timeM').css({"height":"30px"});
            }else if(listL>3){
                $('#timeM').css({"height":"auto","z-index":1000});
            }
        },
        tolerance: "touch"
    });
    $('.btnCal').on('click',function(){
        $('#waiteImg').show();
        setTimeout(function(){
            $('.analysisResult').show();
            $('#waiteImg').hide();
        },3000);

    })
    //删除拖动框中的元素
    $('#remove1').on('click',function(){
        $('#timeD .ui-draggable-handle').remove();
        var timedL=$("#timeD .ui-draggable-handle").length;
        var timemL=$("#timeM .ui-draggable-handle").length;
        if(timedL>0&&timemL>1){
            $('.btnCal').removeAttr('disabled').css({"border":"1px solid blue"});
            $('.selectShow').show();
        }else{
            $('.btnCal').attr('disabled',true).css({"border":"1px solid #ddd","background":"#ddd","color":"#000","opacity":"0.5"});
            $('.selectShow').hide();
        }
        if(timedL==0&&timemL==0){
            $('.analysisResult').hide();
        }
    });
    $('#remove2').on('click',function(){
        $('#timeM .ui-draggable-handle').remove();
        var timedL=$("#timeD .ui-draggable-handle").length;
        var timemL=$("#timeM .ui-draggable-handle").length;
        if(timedL>0&&timemL>1){
            $('.btnCal').removeAttr('disabled').css({"border":"1px solid blue"});
        }else{
            $('.btnCal').attr('disabled',true).css({"border":"1px solid #ddd","background":"#ddd","color":"#000","opacity":"0.5"});
        }
        if(timedL==0&&timemL==0){
            $('.analysisResult').hide();
        }
    })
</script>
</html>